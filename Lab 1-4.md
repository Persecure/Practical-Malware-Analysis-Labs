<!-- wp:paragraph -->
<p>Tools used:</p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul><li>VirusTotal.com</li><li>PEview</li><li>PEiD</li><li>Dependency Walker</li><li>Malcode Analyst Pack</li><li>Resource Hacker</li></ul>
<!-- /wp:list -->

<!-- wp:paragraph {"fontSize":"medium"} -->
<p class="has-medium-font-size"><strong>Questions</strong></p>
<!-- /wp:paragraph -->

<!-- wp:separator -->
<hr class="wp-block-separator has-alpha-channel-opacity"/>
<!-- /wp:separator -->

<!-- wp:paragraph -->
<p>1. Upload the Lab01-04.exe file to http://www.VirusTotal.com/. Does it match any existing antivirus definitions?</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":3743,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://persecure.files.wordpress.com/2022/08/image-605.png?w=789" alt="" class="wp-image-3743"/></figure>
<!-- /wp:image -->

<!-- wp:separator -->
<hr class="wp-block-separator has-alpha-channel-opacity"/>
<!-- /wp:separator -->

<!-- wp:separator -->
<hr class="wp-block-separator has-alpha-channel-opacity"/>
<!-- /wp:separator -->

<!-- wp:paragraph -->
<p>2. Are there any indications that this file is packed or obfuscated? If so, what are these indicators? If the file is packed, unpack it if possible. </p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>No indication from PEview</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":3746,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://persecure.files.wordpress.com/2022/08/image-606.png?w=419" alt="" class="wp-image-3746"/></figure>
<!-- /wp:image -->

<!-- wp:separator -->
<hr class="wp-block-separator has-alpha-channel-opacity"/>
<!-- /wp:separator -->

<!-- wp:paragraph -->
<p>3. When was this program compiled?</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":3748,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://persecure.files.wordpress.com/2022/08/image-607.png?w=812" alt="" class="wp-image-3748"/><figcaption class="wp-element-caption">This is a fake compiled date as the labs and instruction were created in 2014.</figcaption></figure>
<!-- /wp:image -->

<!-- wp:separator -->
<hr class="wp-block-separator has-alpha-channel-opacity"/>
<!-- /wp:separator -->

<!-- wp:paragraph -->
<p>4. Do any imports hint at this programâ€™s functionality? If so, which imports are they and what do they tell you?</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":3750,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://persecure.files.wordpress.com/2022/08/image-608.png?w=663" alt="" class="wp-image-3750"/></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p><strong>ADVAPI32.DLL</strong></p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul><li>The program does something with permissions.</li></ul>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p><strong>KERNEL32.DLL</strong></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Loads data from </p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul><li>LoadResource</li><li>FindResourceA</li><li>SizeofResource</li></ul>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p>Writes a file to disk</p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul><li>CreateFileA</li><li>WriteFile</li></ul>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p>Executes the file</p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul><li>WinExec</li></ul>
<!-- /wp:list -->

<!-- wp:separator -->
<hr class="wp-block-separator has-alpha-channel-opacity"/>
<!-- /wp:separator -->

<!-- wp:paragraph -->
<p>5. What host- or network-based indicators could be used to identify this malware on infected machines?</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Use the strings program</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":3752,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://persecure.files.wordpress.com/2022/08/image-609.png?w=652" alt="" class="wp-image-3752"/></figure>
<!-- /wp:image -->

<!-- wp:list -->
<ul><li>The malware does some kind of action to \system32\wupdmgrd.exe.</li><li>Connects back to http://www.practicalmalwareanalysis.com/updater.exe</li></ul>
<!-- /wp:list -->

<!-- wp:separator -->
<hr class="wp-block-separator has-alpha-channel-opacity"/>
<!-- /wp:separator -->

<!-- wp:paragraph -->
<p>6. This file has one resource in the resource section. Use Resource Hacker to examine that resource, and then use it to extract the resource. What can you learn from the resource?</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Use Resource Hacked to analyze the file.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":3756,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://persecure.files.wordpress.com/2022/08/image-610.png?w=1024" alt="" class="wp-image-3756"/><figcaption class="wp-element-caption">The string "This program cannot be run in DOS mode" indicates there is an additional exe file.</figcaption></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Head to action and save as binary file and open the file in PEview.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":3759,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://persecure.files.wordpress.com/2022/08/image-611.png?w=669" alt="" class="wp-image-3759"/></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>This exe access to the network functions. It calls URLDownloadToFile and WinExec that executes the file.</p>
<!-- /wp:paragraph -->
